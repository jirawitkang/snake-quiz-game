/* ui.css — Purple Library Theme (refactored)
   Goals:
   - Single source of truth per component
   - Remove duplicate overlay/overlay-card blocks
   - Keep final BOARD GRID layout as the only truth
   - Remove/neutralize legacy selectors that are no longer used by current index.html/app.js
   - Preserve existing look & behavior (no game logic changes)
*/

/* =========================
   1) TOKENS / THEME
   ========================= */
:root{
  --p-900:#2f2a66;
  --p-800:#3a3178;
  --p-700:#463a86;
  --p-600:#4B3C8C;
  --p-500:#5a4bb0;
  --p-100:#EDE9F7;
  --p-050:#F6F4FB;

  --bg:#f6f6fb;
  --card:#ffffff;
  --text:#1f2330;
  --muted:#6b6f7c;
  --line:#e3e3ee;

  --shadow: 0 8px 22px rgba(31, 35, 48, .08);
  --shadow2: 0 10px 28px rgba(31, 35, 48, .12);
  --radius: 14px;
  --radius-sm: 10px;

  --lobby-chip-h: 28px; /* height of badge/buttons in bars */

  /* Board sizing (single source of truth) */
  --track-gap: 4px;
  --cell-h: 20px;
  --start-w: 180px;
  --finish-w: 88px;
  /* Player List*/
  --name-col-ch: 16ch;
  /* Dice */
  --dice-size: 110px;
  --dice-half: calc(var(--dice-size) / 2);
  --pip: 14px;
  --pip-color: #1f2330;
}

/* =========================
   2) BASE / RESET
   ========================= */
*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans Thai", sans-serif;
  background: var(--bg);
  color: var(--text);
}
button, input, select, textarea { font: inherit; }

/* Accessibility: prefer reduced motion */
@media (prefers-reduced-motion: reduce){
  *{
    transition: none !important;
    scroll-behavior: auto !important;
  }
}

/* =========================
   3) HEADER
   ========================= */
.app-header{
  background: linear-gradient(90deg, var(--p-600), var(--p-800));
  color:#fff;
  padding: 8px 8px;
  position: sticky;
  top: 0;
  z-index: 50;
  box-shadow: 0 6px 18px rgba(0,0,0,.12);
}
.header-inner{
  max-width: 1060px;
  margin: 0 auto;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
}
.brand{ display:flex; align-items:center; gap: 10px; }
.brand-title{ display:flex; flex-direction:column; line-height:1.05; }
.brand-title strong{ font-size: 16px; }
.brand-title span{ font-size: 12px; opacity:.9; }

.header-meta{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.pill{
  background: rgba(255,255,255,.16);
  border: 1px solid rgba(255,255,255,.22);
  border-radius: 999px;
  padding: 6px 10px;
  font-size: 12px;
  white-space: nowrap;
}

/* Brand badge (QR) */
.brand-badge.badge-v1{
  width: 88px;
  height: 44px;
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 6px;
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}
.brand-badge.badge-v1::before{
  content:"";
  position:absolute;
  inset: 6px;
  background:
    conic-gradient(from 90deg,
      var(--p-600) 0 25%, #cfcfd9 0 50%, var(--p-600) 0 75%, #cfcfd9 0 100%);
  background-size: 12px 12px;
  clip-path: polygon(14% 0%, 100% 0%, 86% 100%, 0% 100%);
  filter: drop-shadow(0 8px 14px rgba(0,0,0,.22));
}
.brand-badge.badge-v1::after{
  content:"";
  position:absolute;
  inset: 6px;
  clip-path: polygon(14% 0%, 100% 0%, 86% 100%, 0% 100%);
  background:
    radial-gradient(120% 120% at 22% 30%, rgba(255,255,255,.20), transparent 55%),
    radial-gradient(120% 120% at 78% 72%, rgba(0,0,0,.18), transparent 60%),
    linear-gradient(90deg, rgba(255,255,255,.10), rgba(0,0,0,.10));
  mix-blend-mode: overlay;
  opacity: .9;
  pointer-events: none;
}
.brand-badge.badge-v1 .badge-text{
  position: relative;
  z-index: 2;
  font-weight: 1000;
  font-size: 32px;
  line-height: 1;
  letter-spacing: .6px;
  color: #ffffff;
  max-width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-shadow: 0 6px 14px rgba(0,0,0,.22);
  -webkit-text-stroke: 0 transparent !important;
}

/* =========================
   4) LAYOUT / CONTAINER / GRID
   ========================= */
.container{
  max-width: 1060px;
  margin: 18px auto 28px;
  padding: 0 14px;
}
.grid-2{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}
@media (max-width: 900px){
  .grid-2{ grid-template-columns: 1fr; }
}

/* Section title */
.section-title{
  display:flex;
  align-items:center;
  gap: 10px;
  margin: 18px 0 10px;
  color: var(--p-800);
  font-weight: 900;
  letter-spacing: .2px;
}
.section-title::before{
  content:"";
  width: 8px;
  height: 22px;
  border-radius: 999px;
  background: var(--p-600);
}

/* =========================
   5) CARDS / FORMS / BUTTONS
   ========================= */
.card{
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 14px;
}
.card h2, .card h3{
  margin: 0 0 10px;
  color: var(--p-800);
}
.card p{ color: var(--muted); }

/* Form */
label{
  display:block;
  font-weight: 700;
  color: var(--p-800);
  margin: 10px 0 6px;
  font-size: 13px;
}
input, select{
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--line);
  border-radius: 12px;
  outline: none;
  background: #fff;
  font-size: 14px;
}
input:focus, select:focus{
  border-color: rgba(75,60,140,.65);
  box-shadow: 0 0 0 4px rgba(75,60,140,.12);
}
button:focus-visible, input:focus-visible, select:focus-visible{
  outline: 3px solid rgba(75,60,140,.28);
  outline-offset: 2px;
}

/* Buttons */
button{
  border: none;
  border-radius: 12px;
  padding: 10px 12px;
  font-weight: 800;
  cursor:pointer;
  transition: transform .06s ease, box-shadow .12s ease, opacity .12s ease;
}
button:active{ transform: translateY(1px); }

.btn-primary{
  background: var(--p-600);
  color: #fff;
  box-shadow: 0 10px 18px rgba(75,60,140,.22);
}
.btn-primary:hover{ box-shadow: 0 14px 24px rgba(75,60,140,.28); }

.btn-ghost{
  background: var(--p-100);
  color: var(--p-800);
  border: 1px solid rgba(75,60,140,.20);
}
.btn-ghost:hover{
  box-shadow: 0 10px 18px rgba(75,60,140,.12);
  transform: translateY(-1px);
}

button:disabled{
  opacity: .55;
  cursor: not-allowed;
  box-shadow:none;
}

/* =========================
   6) HOST OPTIONS PANEL (no jump)
   ========================= */
#createRoomBtn{ margin-top: 12px; }
.card.lock-height{ overflow: hidden; }

/* Use height/opacity to hide/show, while allowing JS to toggle class .is-open */
#hostGameOptions{
  display: block !important;     /* keep layout reserved even if inline display:none existed */
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-4px);
  transition: max-height .25s ease, opacity .2s ease, transform .2s ease;
}
#hostGameOptions.is-open{
  max-height: 520px;             /* adjust if panel grows */
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

/* Dotted split */
.card-split{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}
@media (max-width: 900px){
  .card-split{ grid-template-columns: 1fr; }
}
.split-col{ padding: 4px 2px; }
.split-col + .split-col{
  border-left: 2px dotted rgba(75,60,140,.25);
  padding-left: 14px;
}
@media (max-width: 900px){
  .split-col + .split-col{
    border-left: none;
    border-top: 2px dotted rgba(75,60,140,.25);
    padding-left: 2px;
    padding-top: 14px;
  }
}

/* =========================
   7) ENTRY LANDING
   ========================= */
.entry-landing{
  min-height: calc(100vh - 88px);
  display: grid;
  place-items: center;
}
.entry-landing-inner{
  width: 100%;
  text-align: center;
}
.entry-title{
  margin: 0 0 6px;
}
.entry-sub{
  margin: 0 0 14px;
}
.entry-join-btn{
  width: min(520px, 92vw);
  height: 78px;
  font-size: 24px;
  border-radius: 18px;
}

/* =========================
   8) LOBBY / GAME BAR (single source of truth)
   ========================= */
.lobby-bar{
  display:flex;
  align-items:center;
  gap: 10px;
  margin-bottom: 4px;
  flex-wrap: nowrap;   /* do not wrap */
}
.lobby-bar .section-title{
  margin: 0 !important;
  flex: 0 0 auto;
  white-space: nowrap;
}

/* badges: no wrap; scroll-x */
.lobby-badges{
  flex: 1 1 auto;
  min-width: 0;
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap: nowrap;
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: none;
}
.lobby-badges::-webkit-scrollbar{ display:none; }

.lobby-badge{
  height: var(--lobby-chip-h);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0 10px;
  line-height: 1;
  font-size: 12px;
  font-weight: 900;
  border-radius: 999px;
  white-space: nowrap;
  background: #fff;
  border: 1px solid var(--line);
  color: var(--p-800);
  box-shadow: 0 6px 14px rgba(31,35,48,.08);
}

/* actions: right side always single line */
.lobby-actions{
  flex: 0 0 auto;
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap: nowrap;
}
.lobby-actions button{
  height: var(--lobby-chip-h);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding: 0 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 900;
  line-height: 1;
  box-shadow: none;
}

/* Lobby card head */
.lobby-card-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  margin-bottom: 6px;
}
.role-line{
  flex: 1 1 auto;
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
@media (max-width: 520px){
  .lobby-card-head{ flex-wrap: wrap; }
  .role-line{ flex: 1 1 100%; }
}

/* List head row */
.lobby-list-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  margin: 2px 0 8px;
}
.lobby-list-title{
  color: var(--p-800);
  font-weight: 900;
  white-space: nowrap;
}
.lobby-list-actions button,
.lobby-list-actions #startGameBtn{
  height: var(--lobby-chip-h, 28px) !important;
  padding: 0 12px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  line-height: 1 !important;
  border-radius: 999px !important;
  box-shadow: none !important;
}

/* Lobby card spacing */
.lobby-card{
  padding-top: 10px !important;
  padding-bottom: 12px !important;
}

/* Round/phase pills in game bar */
#roundInfo{
  white-space: nowrap;
  font-weight: 900;
}
#phaseInfo{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ================================
   IN-GAME LAYOUT SWITCH
   - before start: nothing changes
   - after start: gameBar+gameArea goes top, lobby bar hidden,
     lobby-card moved under gameArea and hides its head sections
   ================================ */

/* ช่วงเริ่มเกมแล้ว: ซ่อนทั้ง #lobby (เพราะเราจะย้าย lobby-card ออกมาไว้ #lobbyCardHost) */
body.in-game #lobby{
  display: none !important;
}

/* โชว์ slot วาง lobby-card ใต้ gameArea */
body.in-game #lobbyCardHost{
  display: block !important;
  margin-top: 14px;
}

/* ใน lobby-card: ซ่อนหัวส่วนบน + ซ่อนหัวรายชื่อ + ปุ่มเริ่มเล่น (อยู่ในหัวนั้น) */
body.in-game .lobby-card-head,
body.in-game .lobby-list-head{
  display: none !important;
}

/* กันพลาด: ถ้ามีปุ่มเริ่มเล่นหลงเหลือ ให้ซ่อนไว้อีกชั้น */
body.in-game #startGameBtn{
  display: none !important;
}

/* =========================
   9) TABLES (playerList + endGameSummary)
   ========================= */
#playerList,
#endGameSummary{
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* If #playerList is a DIV, list-style has no effect; keep only margin/padding reset */
#playerList{
  padding: 0 !important;
  margin: 0 !important;
}

/* table styling */
#playerList table,
#endGameSummary table{
  width: 100%;
  margin: 0 !important;
  border-collapse: separate !important;
  border-spacing: 0 !important;
  border-radius: var(--radius-sm);
  overflow: hidden;

  /* keep readable on mobile: allow horizontal scroll */
  min-width: max-content;
}
@media (max-width: 520px){
  #playerList table,
  #endGameSummary table{
    min-width: 560px;
  }
}

#playerList th, #playerList td,
#endGameSummary th, #endGameSummary td{
  border: 1px solid var(--line);
  padding: 0px 6px;
  height: 20px;
  text-align: center;
}
#playerList th, #endGameSummary th{
  background: var(--p-100);
  color: var(--p-800);
  font-weight: 900;
}

/* ===== Base fixed layout for both tables ===== */
#playerList table,
#endGameSummary table{
  table-layout: fixed;
}

/* name column shared */
#playerList th.name-col, #playerList td.name-col,
#endGameSummary th.name-col, #endGameSummary td.name-col{
  width: var(--name-col-ch);
  max-width: var(--name-col-ch);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* =========================
   PlayerList: 8 columns
   ========================= */
/* 1) # */
#playerList th:nth-child(1),
#playerList td:nth-child(1){ width: 4ch; }

/* 2) ผู้เล่น (ใช้ .name-col ที่คุณล็อกไว้แล้ว) */

/* 3) ตำแหน่ง */
#playerList th:nth-child(3),
#playerList td:nth-child(3){ width: 6ch; }

/* 4) ทอยแล้ว */
#playerList th:nth-child(4),
#playerList td:nth-child(4){ width: 7ch; }

/* 5) ตอบแล้ว */
#playerList th:nth-child(5),
#playerList td:nth-child(5){ width: 7ch; }

/* 6) ผลทอย */
#playerList td:nth-child(6){
  font-variant-numeric: tabular-nums;
}

/* 6-7) ผลทอย + ผลคำตอบ ให้กว้างเท่ากัน */
#playerList th:nth-child(6),
#playerList td:nth-child(6),
#playerList th:nth-child(7),
#playerList td:nth-child(7){
  width: 16ch;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 8) สถานะผู้เล่น (ย้ายมาท้ายสุด) — แคบได้ เพราะมีแค่ เข้าเส้นชัย/หลุด */
#playerList th:nth-child(8),
#playerList td:nth-child(8){
  width: 9ch; /* แนะนำ 8-10ch พอ */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* =========================
   EndGameSummary: 12 columns
   อันดับ | ผู้เล่น | ตำแหน่งสุดท้าย | ถึงเส้นชัย? | รอบที่ถึง | วิธีถึง
   | ถูก | ผิด | ไม่ทัน | % ถูก | ทอยลูกเต๋า | ผลคำถาม
   ========================= */

/* 1) อันดับ */
#endGameSummary th:nth-child(1),
#endGameSummary td:nth-child(1){ width: 5ch; }

/* 3) ตำแหน่งสุดท้าย */
#endGameSummary th:nth-child(3),
#endGameSummary td:nth-child(3){ width: 10ch; }

/* 4) ถึงเส้นชัย? */
#endGameSummary th:nth-child(4),
#endGameSummary td:nth-child(4){ width: 10ch; }

/* 5) รอบที่ถึง */
#endGameSummary th:nth-child(5),
#endGameSummary td:nth-child(5){ width: 8ch; }

/* 6) วิธีถึง */
#endGameSummary th:nth-child(6),
#endGameSummary td:nth-child(6){
  width: 10ch;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 7-9) ถูก/ผิด/ไม่ทัน */
#endGameSummary th:nth-child(7),
#endGameSummary td:nth-child(7),
#endGameSummary th:nth-child(8),
#endGameSummary td:nth-child(8),
#endGameSummary th:nth-child(9),
#endGameSummary td:nth-child(9){
  width: 6ch;
}

/* 10) % ถูก */
#endGameSummary th:nth-child(10),
#endGameSummary td:nth-child(10){ width: 7ch; }

/* 11) ทอยลูกเต๋า และ 12) ผลคำถาม ให้กว้างเท่ากัน */
#endGameSummary th:nth-child(11),
#endGameSummary td:nth-child(11),
#endGameSummary th:nth-child(12),
#endGameSummary td:nth-child(12){
  width: 18ch;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

#playerList thead th, #endGameSummary thead th{ font-size: 16px; }
#playerList tbody td, #endGameSummary tbody td{ font-size: 16px; }

/* ล็อกความสูงแถวให้เตี้ยลง (ทั้ง header + body) */
#playerList thead th, #endGameSummary thead th,
#playerList tbody td, #endGameSummary tbody td{
  padding: 0 6px !important;
  height: 28px !important;       /* ✅ ลดจากเดิม แต่ยังรองรับ 24px ไม่ค่อยโดนตัด */
  line-height: 28px !important;  /* ✅ กัน line-height ไปดันแถว */
  vertical-align: middle;
}

/* คุม glyph ให้กินพื้นที่จริงน้อยที่สุด */
#playerList td.rolls-col,
#endGameSummary td.rolls-col{
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

#playerList td.rolls-col .rolls-glyph,
#endGameSummary td.rolls-col .rolls-glyph{
  display: inline-block;
  font-size: 26px;     /* ✅ คง 24px ตามที่ต้องการ */
  line-height: 1;      /* ✅ ลดช่องว่างบน/ล่างจาก line box */
  letter-spacing: 1px;
  transform: translateY(-2px); /* ปรับจูนให้กึ่งกลาง (ลอง 0..2px) */
  white-space: nowrap;
}

#playerList tbody td, #endGameSummary tbody td{
  height: 24px !important;
  line-height: 24px !important;
}

#playerList td.rolls-col,
#endGameSummary td.rolls-col{
  overflow: hidden;
}

/* td ยังเป็น table-cell ตามปกติ => เส้นตารางจะตรง */
#playerList td.rolls-col,
#endGameSummary td.rolls-col{
  padding: 0 6px;           /* คุมช่องว่างบนล่าง */
  vertical-align: middle;   /* ช่วยจัดกึ่งกลางแนวตั้ง */
}

/* จัดกลางด้วย inline-flex ที่ span แทน */
#playerList td.rolls-col .rolls-text,
#endGameSummary td.rolls-col .rolls-text{
  display: inline-flex;
  align-items: center;
  justify-content: center;

  font-size: 24px;
  line-height: 1;           /* ลดช่องว่างบน/ล่าง */
  letter-spacing: 1px;
  white-space: nowrap;
}

/* 1) ทำให้ cell ผลทอยมีพื้นที่/การจัดวางที่ยืดหยุ่นขึ้น */
#playerList tbody td.rolls-col,
#endGameSummary tbody td.rolls-col{
  height: 20px;          /* ตามที่คุณต้องการ */
  padding-top: 0;        /* ตัด padding บน */
  padding-bottom: 0;     /* ตัด padding ล่าง */
  line-height: 20px;     /* ให้ baseline อยู่กลางง่ายขึ้น */
  vertical-align: middle;
  overflow: visible;     /* สำคัญ: ไม่ให้ td ตัด */
}

/* 2) ดันตัว glyph ขึ้นตามต้องการ */
#playerList tbody td.rolls-col .rolls-text,
#endGameSummary tbody td.rolls-col .rolls-text{
  display: inline-block;
  transform: translateY(-2px); /* ลอง -4 / -8 ได้แล้ว */
  will-change: transform;
}

/* Rounded corners */
#playerList thead tr th:first-child,
#endGameSummary thead tr th:first-child{ border-top-left-radius: var(--radius-sm); }
#playerList thead tr th:last-child,
#endGameSummary thead tr th:last-child{ border-top-right-radius: var(--radius-sm); }
#playerList tbody tr:last-child td:first-child,
#endGameSummary tbody tr:last-child td:first-child{ border-bottom-left-radius: var(--radius-sm); }
#playerList tbody tr:last-child td:last-child,
#endGameSummary tbody tr:last-child td:last-child{ border-bottom-right-radius: var(--radius-sm); }

/* =========================
   10) GAME AREA / QUESTION AREA
   ========================= */
#gameArea{ margin-top: 0 !important; }

#questionArea.card{ background: var(--p-050); }
#countdownDisplay{
  font-weight: 900;
  color: var(--p-800);
  margin-bottom: 6px;
}
#questionText{
  font-weight: 900;
  color: var(--p-800);
  margin-bottom: 10px;
}
#choicesContainer{
  display: grid;
  gap: 8px;
}

/* Choice buttons */
.choice-btn{
  border-radius: 12px;
  border: 1px solid var(--line);
  background: #fff;
  color: var(--text);
  padding: 10px 12px;
  font-weight: 800;
}
.choice-btn.selected{
  background: var(--p-600);
  color:#fff;
  border-color: rgba(0,0,0,0);
}
.choice-btn.correct{ background:#2e7d32; color:#fff; }
.choice-btn.wrong{ background:#c62828; color:#fff; }

/* =========================
   11) BOARD (GRID ONLY — single source of truth)
   ========================= */

/* Board container scroll */
#board{
  width: 100%;
  margin-top: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 6px;
}

/* Rows */
.board-label-row,
.player-row{
  display:flex;
  align-items:center;
  gap: 8px;
  margin-bottom: 4px;
  width: 100%;
}

/* Track = grid, with fixed columns (Start + 30 cells + Finish) */
.board-track{
  display: grid !important;
  grid-template-columns: var(--start-w) repeat(30, var(--cell-h)) var(--finish-w);
  column-gap: var(--track-gap);
  align-items: center;

  width: max-content;  /* track width based on columns */
  min-width: 100%;     /* but not smaller than container */
}

/* Base cell */
.cell-card{
  position: relative;
  overflow: visible;
  border-radius: 4px;
}

/* Cells 1..30 */
.board-track .cell-card:not(.start-cell):not(.finish-cell),
.board-label-row .cell-card:not(.start-cell):not(.finish-cell){
  height: var(--cell-h) !important;
  padding: 0 !important;
  line-height: 1 !important;
  box-sizing: border-box;
  border-radius: 4px !important;
  box-shadow: 0 3px 6px rgba(0,0,0,0.18);
  display:flex;
  align-items:center;
  justify-content:center;

  width: auto !important;
  flex: none !important;
}
.board-label-row .cell-card:not(.start-cell):not(.finish-cell){ background:#fff; }

.cell-card.play-cell{ background:#fff; }
.cell-card.play-cell.cell-dice{ background:#64b5f6 !important; }
.cell-card.play-cell.cell-correct{ background:#66bb6a !important; }
.cell-card.play-cell.cell-wrong{ background:#ef5350 !important; }
.cell-card.play-cell.cell-past{ background:#9e9e9e !important; }

/* Start/Finish cells */
.start-cell,
.finish-cell{
  height: var(--cell-h) !important;
  border-radius: 4px !important;
  background:#fff;
  box-shadow: 0 3px 6px rgba(0,0,0,0.18);
  display:flex;
  align-items:center;
  justify-content:center;
  box-sizing:border-box;
  min-width: 0 !important;
}

/* Start = player name on player rows */
.start-cell{
  width: var(--start-w) !important;
  border-right: 3px solid var(--p-600) !important;
  font-weight: 900;
  color: var(--p-800);
  padding: 0 10px !important;
  justify-content: flex-start !important;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

/* Finish marker */
.finish-cell{
  width: var(--finish-w) !important;
  border-left: 3px solid #43a047 !important;
}

/* Cell label (numbers / Start / Finish label row) */
.cell-label{
  font-size: 12px;
  color: var(--p-800);
  font-weight: 900;
}

/* Token (droplet) */
.token{
  position:absolute;
  width: 22px;
  height: 22px;
  background:#ffb300;
  border-radius: 50% 50% 50% 0;
  box-shadow: 0 3px 6px rgba(0,0,0,0.3);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index: 2;
  left: 50%;
  top: 0;
  transform-origin: 50% 50%;
  transform: translate(-50%, -40%) rotate(-45deg);
}
.token-inner{
  width: 12px;
  height: 12px;
  background: rgba(255,255,255,0.95);
  border-radius: 50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: 9px;
  font-weight: 900;
  color:#333;
  transform: rotate(45deg);
}

/* =========================
   12) OVERLAYS (Admin + Dice) — unified (no duplicates)
   ========================= */
.overlay{
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background: rgba(20, 18, 40, .42);
  backdrop-filter: blur(6px);
}
@media (prefers-reduced-motion: reduce){
  .overlay{ backdrop-filter: none; }
}

.overlay-card{
  width: min(420px, 92vw);
  max-height: min(78vh, 640px);
  overflow: auto;
  background: #fff;
  border: 1px solid var(--line);
  border-radius: 18px;
  box-shadow: var(--shadow2);
  padding: 16px;
  text-align: center;
}
.overlay-title{
  font-weight: 900;
  color: var(--p-800);
  margin-bottom: 12px;
}
.overlay-hint{
  margin-top: 12px;
  color: var(--muted);
  font-weight: 800;
}
#closeDiceOverlayBtn{
  width: 100%;
  justify-content: center;
}

/* Dice 3D stage */
.dice-scene{
  perspective: 900px;
  perspective-origin: 50% 40%;
  display: grid;
  place-items: center;
  margin: 14px 0 10px;
}
.dice-cam{
  transform-style: preserve-3d;
  transform: rotateX(55deg) rotateZ(45deg);
}
#dice3d.dice{
  width: var(--dice-size);
  height: var(--dice-size);
  position: relative;
  transform-style: preserve-3d;
}
#dice3d .face{
  position: absolute;
  inset: 0;
  background: #fff;
  border: 3px solid #111;
  border-radius: 18px;
  box-shadow: 0 14px 26px rgba(0,0,0,.18);
  backface-visibility: hidden;
}
#dice3d .face-1{ transform: rotateY(0deg)   translateZ(var(--dice-half)); }   /* front */
#dice3d .face-2{ transform: rotateY(90deg)  translateZ(var(--dice-half)); }   /* right */
#dice3d .face-6{ transform: rotateY(180deg) translateZ(var(--dice-half)); }   /* back */
#dice3d .face-5{ transform: rotateY(-90deg) translateZ(var(--dice-half)); }  /* left */
#dice3d .face-3{ transform: rotateX(-90deg) translateZ(var(--dice-half)); }  /* top */
#dice3d .face-4{ transform: rotateX(90deg)  translateZ(var(--dice-half)); }  /* bottom */

#dice3d .pip{
  position: absolute;
  width: var(--pip);
  height: var(--pip);
  border-radius: 50%;
  background: var(--pip-color);
  box-shadow: inset 0 2px 0 rgba(255,255,255,.35);
}
#dice3d .pip.tl{ left: 22%; top: 22%; }
#dice3d .pip.tr{ right: 22%; top: 22%; }
#dice3d .pip.ml{ left: 22%; top: 50%; transform: translateY(-50%); }
#dice3d .pip.mr{ right: 22%; top: 50%; transform: translateY(-50%); }
#dice3d .pip.bl{ left: 22%; bottom: 22%; }
#dice3d .pip.br{ right: 22%; bottom: 22%; }
#dice3d .pip.c{ left: 50%; top: 50%; transform: translate(-50%,-50%); }

/* =========================
   13) UTILITIES
   ========================= */
.muted{ color: var(--muted); }
.mt-10{ margin-top:10px; }
.mt-14{ margin-top:14px; }

/* ===== PATCH: Player list table spacing + compact rows ===== */

/* ทำให้พื้นที่รอบตารางเท่ากันทุกด้านภายใน lobby-card */
#playerList{
  padding: 0px !important;   /* ✅ ระยะเท่ากันทุกด้าน */
  margin: 0 !important;
}

/* ตารางไม่ต้องมี margin แปลก ๆ */
#playerList table{
  margin: 0 !important;
}

/* ลดขนาดตัวอักษรในตารางรายชื่อผู้เล่น */
#playerList table{
  font-size: 11px;           /* ✅ เล็กลง (เดิม ~14px) */
  line-height: 1.15;         /* ✅ ลดความสูงบรรทัด */
}

/* ลด padding ของหัวตารางและข้อมูล (ทำให้แถวเตี้ยลงมาก) */
#playerList th,
#playerList td{
  padding: 4px 6px !important;  /* ✅ จาก 8px -> 4/6px */
}

/* หัวตารางให้กระชับ */
#playerList th{
  font-size: 11px;
}

/* ชื่อผู้เล่น (name-col) ไม่ต้องใหญ่เกิน */
#playerList td.name-col{
  font-weight: 800;
}

#playerList th, #playerList td{
  white-space: nowrap;      /* กันขึ้นบรรทัดใหม่ ทำให้แถวเตี้ย */
}
#playerList{
  max-height: 52vh;         /* ให้ card scroll ได้ถ้าผู้เล่นเยอะ */
  overflow: auto;
}

/* Header action buttons: keep compact */
.header-meta button.pill{
  height: 30px;
  padding: 0 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
